/**
 * Loading Animation System - Unified Shimmer Effect
 * 
 * Centralized shimmer loading states for all El Camino components.
 * Provides consistent, accessible, and theme-aware loading animations.
 * 
 * Features:
 * - CSS custom properties for theming
 * - Automatic dark mode support
 * - Network-aware (disables on slow connections)
 * - Respects prefers-reduced-motion
 * - GPU-accelerated animations
 * 
 * Usage:
 *   <div class="loading-skeleton loading-image">
 *     <!-- Logo overlay optional -->
 *   </div>
 * 
 * Documentation: /docs/LOADING_STATES.md
 * Reference: ProductCard.astro, ArticleCard.astro
 */

/* CSS Variables for theming */
@property --loading-opacity{syntax:"<number>";initial-value:1;inherits:false}

:root{
--loading-duration:1.5s;--loading-delay-increment:0.1s;--shimmer-duration:2s;--fade-duration:300ms;
--loading-color-primary:hsl(200,20%,80%);--loading-color-secondary:hsl(200,20%,95%);
--loading-color-shimmer:rgba(255,255,255,0.3);--loading-radius:0.25rem;
}

@keyframes loading-pulse{0%,100%{opacity:1;transform:translateZ(0)}50%{opacity:0.7}}
@keyframes loading-shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}

.loading-skeleton{
background:linear-gradient(to bottom right, var(--surface-secondary, hsl(200,20%,95%)), var(--surface-tertiary, hsl(200,20%,90%)));
border-radius:var(--loading-radius);
will-change:opacity,transform;animation:loading-pulse var(--loading-duration) ease-in-out infinite;
position:relative;overflow:hidden;transform:translateZ(0);backface-visibility:hidden;
perspective:1000;contain:layout style paint;
}

.loading-skeleton::before{
content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;
background:linear-gradient(90deg,transparent,var(--loading-color-shimmer),transparent);
animation:loading-shimmer var(--shimmer-duration) infinite;will-change:transform;
}

/* Staggered delays */
.loading-skeleton:nth-child(2){animation-delay:calc(var(--loading-delay-increment)*1)}
.loading-skeleton:nth-child(3){animation-delay:calc(var(--loading-delay-increment)*2)}
.loading-skeleton:nth-child(4){animation-delay:calc(var(--loading-delay-increment)*3)}
.loading-skeleton:nth-child(5){animation-delay:calc(var(--loading-delay-increment)*4)}
.loading-skeleton:nth-child(6){animation-delay:calc(var(--loading-delay-increment)*5)}

/* Component classes - compressed */
.loading-image{aspect-ratio:16/9;width:100%;height:100%}
.loading-image.compact{height:250px}
.loading-image.featured{aspect-ratio:2/1}
.loading-title{height:1.5rem;width:80%;margin:0.5rem 0}
.loading-title.multi-line{margin-bottom:0.25rem}
.loading-title.multi-line:last-of-type{width:60%}
.loading-price{height:1.25rem;width:40%}
.loading-text-line{height:1rem;width:100%;margin-bottom:0.5rem}
.loading-text-line:nth-child(2){width:85%}
.loading-text-line:last-child{width:75%}
.loading-badge{height:1.25rem;width:4rem;border-radius:0.75rem}
.loading-brand{height:0.875rem;width:45%;margin-bottom:0.5rem}
.loading-tag{height:1.5rem;width:4rem;border-radius:0.25rem}

/* Layouts */
.loading-product-card{display:grid;grid-template-rows:auto 1fr;gap:0.5rem;width:100%;padding:0.25rem}
.loading-product-content{display:grid;padding:0.25rem;gap:0.5rem}
.loading-article-card{display:flex;flex-direction:column}
.loading-article-content{flex:1;padding:1rem;display:flex;flex-direction:column;gap:0.75rem}
.loading-article-tags{display:flex;gap:0.5rem;margin-top:auto}

/* Network-aware */
.network-slow-2g .loading-skeleton,.network-2g .loading-skeleton,.loading-minimal .loading-skeleton{animation:none;background:var(--loading-color-secondary)}
.network-slow-2g .loading-skeleton::before,.network-2g .loading-skeleton::before,.loading-no-shimmer .loading-skeleton::before{display:none}
.loading-skeleton-minimal{border-radius:2px;background:var(--loading-color-secondary);animation:none}

/* Transitions */
.loading-to-content{opacity:0;transform:translateY(4px);transition:opacity var(--fade-duration) ease,transform var(--fade-duration) ease}
.loading-to-content.loaded{opacity:1;transform:translateY(0)}

/* Error states */
.loading-error{background:#fee2e2;border:1px solid #fca5a5;color:#dc2626;display:flex;align-items:center;justify-content:center;min-height:3rem}
.loading-error::after{content:"âš  Failed to load";font-size:0.875rem;font-weight:500}
.loading-retry-button{background:#3b82f6;color:white;border:none;padding:0.5rem 1rem;border-radius:0.25rem;cursor:pointer;margin-top:0.5rem;font-size:0.875rem}
.loading-retry-button:hover{background:#2563eb}

/* Container queries */
.loading-container{container:loading-layout/inline-size}
@container loading-layout (width < 400px){.loading-skeleton.loading-image{aspect-ratio:4/3}.loading-skeleton.loading-title{width:90%}}
@container loading-layout (width >= 400px){.loading-skeleton.loading-image{aspect-ratio:16/9}.loading-skeleton.loading-title{width:80%}}

/* Accessibility & responsive */
@media (prefers-reduced-motion:reduce){.loading-skeleton,.loading-skeleton::before{animation:none!important}.loading-skeleton{background:var(--loading-color-secondary)}.loading-to-content{transition:none!important;transform:none!important}}
@media (prefers-color-scheme:dark){:root{--loading-color-primary:hsl(200,10%,25%);--loading-color-secondary:hsl(200,10%,35%);--loading-color-shimmer:rgba(255,255,255,0.1)}}
@media (prefers-contrast:high){.loading-skeleton{background:Canvas;border:2px solid CanvasText}}
@media (max-width:768px){.loading-image{height:250px}.loading-skeleton{border-radius:0.125rem}}