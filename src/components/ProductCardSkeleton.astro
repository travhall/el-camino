---
// src/components/ProductCardSkeleton.astro - Updated with Unified Loading System
interface Props {
  priority?: boolean;
  variant?: "default" | "compact" | "featured";
  index?: number;
}

const { priority = false, variant = "default", index = 0 } = Astro.props;

// Calculate stagger delay for animation timing
const staggerDelay = index * 0.1;

// Determine image class based on variant
const imageClass = variant === "compact" ? "loading-image compact" :
                   variant === "featured" ? "loading-image featured" : "loading-image";

// Container classes for the variant
const containerClass = `loading-container loading-product-card ${variant === "featured" ? "col-span-2" : ""}`;
---

<div
  class={containerClass}
  role="status"
  aria-label="Loading product..."
  style={`--loading-stagger-delay: ${staggerDelay}s`}
>
  <!-- Unified Image Skeleton -->
  <div class={`loading-skeleton ${imageClass}`}></div>
  
  <!-- Unified Content Skeleton -->
  <div class="loading-product-content">
    <div class="loading-skeleton loading-brand"></div>
    <div class="loading-skeleton loading-title"></div>
    <div class="loading-skeleton loading-title multi-line"></div>
    <div class="loading-skeleton loading-price"></div>
  </div>
  
  <span class="sr-only">Loading product information...</span>
</div>

<style>
  /* Import unified loading animations */
  @import url('/src/styles/animations/loading.css');
  
  /* Component-specific overrides only */
  .loading-product-card {
    background: var(--ui-card-surface, #ffffff);
    border: 1px solid var(--ui-card-border, #e5e7eb);
    border-radius: 0.375rem;
    padding: 0.25rem;
  }
  
  /* Maintain existing responsive behavior */
  @media (max-width: 768px) {
    .loading-image {
      height: 250px;
    }
  }
  
  /* Ensure proper aspect ratios are maintained */
  .loading-image.compact {
    aspect-ratio: 4 / 3;
  }
  
  .loading-image.featured {
    aspect-ratio: 2 / 1;
  }
  
  /* Dark theme integration */
  :global([data-theme="dark"]) .loading-product-card {
    background: var(--ui-card-surface-dark, #1f2937);
    border-color: var(--ui-card-border-dark, #374151);
  }
</style>